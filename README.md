# pre_order_flutter_app

[![Codemagic build status](https://api.codemagic.io/apps/6098b499f3dcf2b4763b420c/6098b499f3dcf2b4763b420b/status_badge.svg)](https://codemagic.io/apps/6098b499f3dcf2b4763b420c/6098b499f3dcf2b4763b420b/latest_build)

## æ³¨æ„ç‚¹

- Codemagic ã¨ã®é€£æºã¯ç¾åœ¨ OFF ã«ã—ã¦ã„ã‚‹ã®ã§ã€CI/CDã¯å‹•ãã¾ã›ã‚“ã€‚
ãã®ãŸã‚ã€ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã‚¢ãƒ—ãƒªã‚’é…å¸ƒã—ãŸã„å ´åˆã¯ã€ŒBuild to Firebase App Distributionã€ã®è¨˜è¼‰ã®æ‰‹é †ã§ Firebase App Distribution ã‹ã‚‰é…å¸ƒã—ã¦ãã ã•ã„ã€‚ãŸã ã—ã€ãã‚Œã‚’è¡Œã†ãŸã‚ã«ã¯ Firebase ã¸ã®æŽ¥ç¶šã®ãŸã‚ã®éµãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚¢ãƒ—ãƒªç½²åã®ãŸã‚ã®éµãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã«ãªã‚‹ã®ã§é«˜æ©‹ã¾ã§ã”é€£çµ¡ãã ã•ã„ã€‚ï¼ˆã“ã®ã‚ˆã†ã«é‹ç”¨ã«å±žäººçš„ã«ãªã‚‰ãªã„ãŸã‚ã«ã‚‚ Codemagic ãªã©ã§ã® CI/CD ã®ä»•çµ„ã¿ã¥ãã‚Šã¯å¤§äº‹ã€‚ï¼‰
- Firebase ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯é«˜æ©‹å€‹äººã®ã‚‚ã®ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã¾ã™ã€‚äºˆå‘Šãªãã‚¢ãƒ—ãƒªãŒä½¿ç”¨ã§ããªããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã”äº†æ‰¿ãã ã•ã„ã€‚ã¾ãŸã€å¾“é‡èª²é‡‘ã®è¨­å®šãªã®ã§å„ªã—ãä½¿ã£ã¦ã„ãŸã ã‘ã‚‹ã¨å¹¸ã„ã§ã™ã€‚

## ã‚¢ãƒ—ãƒªã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ–¹æ³•

ã€ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€‘  
ç”¨é€”ï¼šå…±æœ‰ã® App Distribution ã§é…ä¿¡ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆã‚¢ãƒ—ãƒªã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰  
ç«¯æœ«æ¡ä»¶ï¼šiOS 14.4ä»¥ä¸Šã®ç«¯æœ«ã€Android11ä»¥ä¸Šã®ç«¯æœ«  

â– iOS  
iOSã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼šiseshopuser@gmail.com  
iOSã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼šise20212021  
iOSã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆãƒªãƒ³ã‚¯ï¼šhttps://appdistribution.firebase.dev/i/38515203481b7a05  

â– Android  
Androidã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼šisetaroand@gmail.com  
Androidã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼šise20212021  
Androidã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆãƒªãƒ³ã‚¯ï¼šhttps://appdistribution.firebase.dev/i/a8d4afe85f96f762  

â– å¤§ã¾ã‹ãªãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ–¹æ³•  
App Testerã‚¢ãƒ—ãƒªã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰â†’å¯¾è±¡ã®ã‚¢ãƒ—ãƒªã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ã„ã†æ‰‹é †ã§ã™ã€‚
1. iPhone or Android ç«¯æœ«ã‹ã‚‰ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆãƒªãƒ³ã‚¯ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
2. iOS ãªã‚‰ iOS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€Android ãªã‚‰ Android ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä¸Šè¨˜è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹
3. Gmail ã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ï¼ˆå…±æœ‰ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚‚ã—ã‹ã™ã‚‹ã¨äºŒè¦ç´ èªè¨¼ã«å¼•ã£ã‹ã‹ã£ã¦èª°ã‹ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆã—ã¦ã‚‚ã‚‰ã‚ãªã„ã¨ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ï¼‰
4. æœ€æ–°ï¼ˆãŠãã‚‰ãï¼‰ã®ãƒ¡ãƒ¼ãƒ«ã®ä¸­å¤®éƒ¨ã«ã€ŒInstall Firebase App Testerã€ã¨ã‚ã‚‹ã®ã§ã€ãã“ã‹ã‚‰ã€ŒApp Testerã€ã‚¢ãƒ—ãƒªã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ï¼ˆâ€»ã“ã“ã§ Download the latest build ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã‚‚ App Tester ã®ã‚¢ãƒ—ãƒªãŒãªã„ãŸã‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ããªã„ï¼‰
5. App Tester ã‚’ç«‹ã¡ä¸Šã’ã‚‹ã¨ Google ã®ãƒ­ã‚°ã‚¤ãƒ³ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã®ã§ã€ãã“ã§ã¯å…ˆç¨‹ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ï¼ˆâ€»å€‹äººã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ä½¿ç”¨ã—ãªã„ï¼‰
6. ç”»é¢ã®æŒ‡ç¤ºé€šã‚Šã«æ“ä½œã—ã¦ã„ãã¨ App Tester ã«ãƒ€ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã‚¢ãƒ—ãƒªã®ä¸€è¦§ãŒå‡ºã¦ãã‚‹ã®ã§ã€1ç•ªä¸Šã®ã‚¢ãƒ—ãƒªï¼ˆæœ€æ–°ã®ã‚¢ãƒ—ãƒªï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
7. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«æˆåŠŸã™ã‚‹ã¨ãƒ›ãƒ¼ãƒ ç”»é¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚¢ãƒ—ãƒªãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€ãã‚Œã‚’èµ·å‹•ã™ã‚‹ã¨ã‚¢ãƒ—ãƒªãŒæ“ä½œã§ãã‚‹

â– æ‰‹é †ã®å‚è€ƒã¨ãªã‚‹ãƒªãƒ³ã‚¯  
â€»æ¡ä»¶ãŒç•°ãªã‚‹ãŸã‚å…¨ãåŒã˜æ‰‹é †ã§ã¯ã‚ã‚Šã¾ã›ã‚“  

ã€iOSå‚è€ƒã€‘[iOS] Firebase App Distributionã‚’ä½¿ç”¨ã—ã¦iOSã‚¢ãƒ—ãƒªã‚’é…å¸ƒã™ã‚‹  
https://dev.classmethod.jp/articles/ios-firebase-distribution/  

ã€Androidå‚è€ƒã€‘Firebase App Distributionã§Androidã‚¢ãƒ—ãƒªã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ–¹æ³•  
https://pentagon.tokyo/app/2312/  

## Architecture

![](./reference/architecture.drawio.svg)

## CI/CD

![](./reference/cicd.drawio.svg)

## Requirements

- Flutter: 2.0.6
- Dart: 2.12.3
- Xcode: 12.5
- Android Studio: 4.2

```shell
$ flutter --version
Flutter 2.0.6 â€¢ channel stable â€¢ https://github.com/flutter/flutter.git
Framework â€¢ revision 1d9032c7e1 (12 days ago) â€¢ 2021-04-29 17:37:58 -0700
Engine â€¢ revision 05e680e202
Tools â€¢ Dart 2.12.3

$ sw_vers
ProductName:	macOS
ProductVersion:	11.3.1
BuildVersion:	20E241

$ xcodebuild -version
Xcode 12.5
Build version 12E262

$ flutter doctor -v
[âœ“] Flutter (Channel stable, 2.0.6, on macOS 11.3.1 20E241 darwin-x64, locale ja-JP)
    â€¢ Flutter version 2.0.6 at /Users/sugurutakahashi/development/flutter
    â€¢ Framework revision 1d9032c7e1 (12 days ago), 2021-04-29 17:37:58 -0700
    â€¢ Engine revision 05e680e202
    â€¢ Dart version 2.12.3

[âœ“] Android toolchain - develop for Android devices (Android SDK version 29.0.3)
    â€¢ Android SDK at /Users/sugurutakahashi/Library/Android/sdk
    â€¢ Platform android-30, build-tools 29.0.3
    â€¢ Java binary at: /Applications/Android Studio.app/Contents/jre/jdk/Contents/Home/bin/java
    â€¢ Java version OpenJDK Runtime Environment (build 11.0.8+10-b944.6916264)
    â€¢ All Android licenses accepted.

[âœ“] Xcode - develop for iOS and macOS
    â€¢ Xcode at /Applications/Xcode.app/Contents/Developer
    â€¢ Xcode 12.5, Build version 12E262
    â€¢ CocoaPods version 1.10.1

[âœ“] Chrome - develop for the web
    â€¢ Chrome at /Applications/Google Chrome.app/Contents/MacOS/Google Chrome

[âœ“] Android Studio (version 4.2)
    â€¢ Android Studio at /Applications/Android Studio.app/Contents
    â€¢ Flutter plugin can be installed from:
      ðŸ”¨ https://plugins.jetbrains.com/plugin/9212-flutter
    â€¢ Dart plugin can be installed from:
      ðŸ”¨ https://plugins.jetbrains.com/plugin/6351-dart
    â€¢ Java version OpenJDK Runtime Environment (build 11.0.8+10-b944.6916264)

[âœ“] VS Code (version 1.56.1)
    â€¢ VS Code at /Applications/Visual Studio Code.app/Contents
    â€¢ Flutter extension version 3.22.0

[âœ“] Connected device (1 available)
    â€¢ Chrome (web) â€¢ chrome â€¢ web-javascript â€¢ Google Chrome 90.0.4430.212

â€¢ No issues found!
```

### Build to Firebase App Distribution

#### Android:

```shell
$ cd android
$ fastlane distribute
```

#### iOS:

```shell
$ cd ios
$ fastlane distribute
```

### build to TestFlight

#### iOS:

```shell
$ cd ios
$ fastlane beta
```


### Enabling debug mode Local (Firebase Analitycis)

#### Android:

To enable Analytics Debug mode on an Android device, execute the following commands:

```shell
$ adb shell setprop debug.firebase.analytics.app ise.sr.u2021.pre_order_flutter_app
```

This behavior persists until you explicitly disable Debug mode by executing the following command:

```shell
$ adb shell setprop debug.firebase.analytics.app .none.
```

#### iOS:

Settings: Xcode > Product > Scheme > Edit Scheme > Run > Aguments

**Run Build in Xcode!!**

To enable Analytics Debug mode on your development device, specify the following command line argument in Xcode :

```
-FIRDebugEnabled
```

This behavior persists until you explicitly disable Debug mode by specifying the following command line argument :

```
-FIRDebugDisabled
```
